{"version":3,"file":"model.js","sourceRoot":"","sources":["../../../../src/project/versioned/v0_2_1/model.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,sCAAsC;;;;;;;;;;;;AAEtC,yDAAqD;AACrD,qDAAoG;AACpG,sCAKmB;AAGnB,MAAa,6BAA8B,SAAQ,oCAA2B;CAG7E;AADC;IADC,IAAA,0BAAQ,GAAE;;2DACE;AAFf,sEAGC;AAED,MAAa,4BAA6B,SAAQ,mCAA0B;CAG3E;AADC;IADC,IAAA,0BAAQ,GAAE;;0DACE;AAFf,oEAGC;AAED,MAAa,gBAAiB,SAAQ,yBAAgB;CAgBrD;AAbC;IAFC,IAAA,wBAAM,EAAC,OAAO,CAAC;IACf,IAAA,0BAAQ,GAAE;;qDACS;AAYpB;IAVC,IAAA,4BAAU,GAAE;IACZ,IAAA,yBAAO,GAAE;IACT,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,4BAA4B,EAAE;QACxC,aAAa,EAAE;YACb,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,CAAC,EAAC,KAAK,EAAE,6BAA6B,EAAE,IAAI,EAAE,mBAAmB,EAAC,CAAC;SAC9E;QACD,yBAAyB,EAAE,IAAI;KAChC,CAAC;;mDACmE;AAfvE,4CAgBC;AAED,MAAa,yBAA0B,SAAQ,kCAAyB;IActE,IAAI,UAAU;QACZ,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAA,gCAAY,EAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;YACxD,IAAA,8BAAY,EAAC,IAAI,CAAC,WAAW,EAAE,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC,CAAC;SACnD;QACD,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;CACF;AAVC;IAVC,IAAA,4BAAU,GAAE;IACZ,IAAA,yBAAO,GAAE;IACT,IAAA,gCAAc,GAAE;IAChB,IAAA,wBAAI,EAAC,GAAG,EAAE,CAAC,4BAA4B,EAAE;QACxC,aAAa,EAAE;YACb,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,CAAC,EAAC,KAAK,EAAE,6BAA6B,EAAE,IAAI,EAAE,mBAAmB,EAAC,CAAC;SAC9E;QACD,yBAAyB,EAAE,IAAI;KAChC,CAAC;;4DACmE;AAXvE,8DAqBC","sourcesContent":["// Copyright 2020-2021 OnFinality Limited authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\nimport {plainToClass, Type} from 'class-transformer';\nimport {Equals, IsArray, IsOptional, IsString, ValidateNested, validateSync} from 'class-validator';\nimport {\n  CustomDataSourceV0_2_0Impl,\n  DeploymentV0_2_0,\n  ProjectManifestV0_2_0Impl,\n  RuntimeDataSourceV0_2_0Impl,\n} from '../v0_2_0';\nimport {CustomDatasourceTemplate, ProjectManifestV0_2_1, RuntimeDatasourceTemplate} from './types';\n\nexport class RuntimeDatasourceTemplateImpl extends RuntimeDataSourceV0_2_0Impl implements RuntimeDatasourceTemplate {\n  @IsString()\n  name: string;\n}\n\nexport class CustomDatasourceTemplateImpl extends CustomDataSourceV0_2_0Impl implements CustomDatasourceTemplate {\n  @IsString()\n  name: string;\n}\n\nexport class DeploymentV0_2_1 extends DeploymentV0_2_0 {\n  @Equals('0.2.1')\n  @IsString()\n  specVersion: string;\n\n  @IsOptional()\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CustomDatasourceTemplateImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: RuntimeDatasourceTemplateImpl, name: 'substrate/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  templates?: (RuntimeDatasourceTemplate | CustomDatasourceTemplate)[];\n}\n\nexport class ProjectManifestV0_2_1Impl extends ProjectManifestV0_2_0Impl implements ProjectManifestV0_2_1 {\n  @IsOptional()\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CustomDatasourceTemplateImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: RuntimeDatasourceTemplateImpl, name: 'substrate/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  templates?: (RuntimeDatasourceTemplate | CustomDatasourceTemplate)[];\n  protected _deployment: DeploymentV0_2_1;\n\n  get deployment(): DeploymentV0_2_1 {\n    if (!this._deployment) {\n      this._deployment = plainToClass(DeploymentV0_2_1, this);\n      validateSync(this._deployment, {whitelist: true});\n    }\n    return this._deployment;\n  }\n}\n"]}